#!/bin/bash
# add XML to scanned book page

PN=`basename "$0"`                      # Program name
VER='1.0'				# version name

Usage () {
    echo >&2 "$PN - add XML tags to scanned book page, version $VER
    usage: $PN [-h] [file(s) ...]"
    exit 1
}

while getopts :hv opt
do
    case "$opt" in
                                        # your flags here
        h)      Usage;;
        v)      echo "$PN - add XML tags to scanned book page, version $VER" >&2
                exit 1;;
        '?')    echo "$0: invalid option -$OPTARG" >&2
		echo "usage: $0 [-hv] [file(s) ...]" >&2
           exit 1
           ;;
    esac
    shift
done

shift $((OPTIND - 1))                   #Remove options, leave arguments

#for f in *.txt; do
	# If first line of page begins/ends with a page number,
	# capture it in a pb (page-break) element
	sed \
	-e 's/^\([0-9]\{1,3\}\).*$/<pb n="\1" facs=""\/>/' \
       	-e 's/^[^0-9]*\([0-9]\{1,3\}\)$/<pb n="\1" facs=""\/>/' \
	"$@"
#done
